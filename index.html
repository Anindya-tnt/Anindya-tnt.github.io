<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>MOOCbook - Unsupervised Learning</title>
<link rel="stylesheet" href="css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" href="css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
<link rel="stylesheet" href="MOOC Vid CSS/video-canvas.css" />
<link href="css/video-js.css" rel="stylesheet">
<link href="css/videojs-transcript.css" title="Example 1" rel="stylesheet">
<link rel="stylesheet" href="css/style.css" />

<link rel="stylesheet" href="css/animate.css">
<link rel="stylesheet" href="css/font-awesome.min.css">
<link rel="stylesheet" href="css/templatemo-style.css">

<link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700" rel="stylesheet">

 <link href="//netdna.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.css" rel="stylesheet">
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.js"></script> 
  <script src="//netdna.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.js"></script> 
  <link href="//cdnjs.cloudflare.com/ajax/libs/summernote/0.8.3/summernote.css" rel="stylesheet">
  <script src="//cdnjs.cloudflare.com/ajax/libs/summernote/0.8.3/summernote.js"></script>

<!-- <script src="js/jquery-1.11.1.min.js"></script> -->
<script src="js/script.js"></script> 
<style type="text/css">   
    .video-js {
      margin: 40px auto;
    }
</style>

<script src="js/video.js"></script>
<script src="js/videojs-transcript.js"></script>
</head>
<body style="background-color: #f5e8d4;">
  <div class="preloader">
     <div class="spinner">
          <span class="spinner-rotate"></span>
     </div>
  </div>

  <div class="jumbotron specialjum">
    <div class="over container body-content">
    <div class="row">
      <div class="col-xs-12 br1"><br/></div>
    </div>
  <div class="row">
  <div class="col-xs-4" id="vid">
      <h4>Lecture Video</h4>
  <div class="video-container">
    <video id="video" class="video-js" width="400" height="300" controls>
      <source src="./media/Introduction-UnsupervisedLearning.mp4" type="video/mp4" width="300" height="360">
      <track id='entrack' kind="captions" src="captions/captions.vtt" srclang="en" label="English subtitles" default>

    </video>
    </div>
    </div>
    <div class="col-xs-4"><div id="transcript" align="left" style="position: relative; margin-top:80px; padding-left: 0px; margin-left: 80px; width:280px;height:300px; border:2px solid black"></div></div>
    <div class="col-xs-4" style="margin-top:50px">
      <h4>Preview Snapshot</h4>
      
      
      <canvas id="canvas1" allign="right" style="position: relative;"></canvas>
      <div class="NoteButtons">
       <!-- Screeshot Controls -->
            <input id="figDesc" type="text" placeholder="Add optional figure description" style="width:300px; padding-left: 7px"></input>
            <button class="btn btn-primary" type="button" id="snap">Select KeyFrame</button>
          <button class="btn btn-success" type="button" id="saveImage">Save Image</button>
          <button class="btn btn-info" type="button" onclick="save()" id="cloneImage">Add To Note</button>
          
          
      </div>

    </div>
    
    <script>
      var video = videojs('video').ready(function(){

          // fire up the plugin
          var transcript = this.transcript();

          // attach the widget to the page
          var transcriptContainer = document.querySelector('#transcript');
          transcriptContainer.appendChild(transcript.el());
      });
    </script>
    </div>

  
  
  
  <div class="navbar navbar-fixed-top custom-navbar" role="navigation">
     <div class="container">

          <!-- navbar header -->
          <div class="navbar-header">
               <button class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="icon icon-bar"></span>
                    <span class="icon icon-bar"></span>
                    <span class="icon icon-bar"></span>
               </button>
               <a href="#" class="navbar-brand" style="margin-left:15px">MOOCbook</a>
          </div>

          <div class="collapse navbar-collapse">
                <ul class="nav navbar-nav navbar-left" style="margin-left: 60px">
                    <li><a href="test.php">Unsupervised Learning</a></li>
                </ul>
               <ul class="nav navbar-nav navbar-right" style="margin-right: 60px">
                    
                    <li><a href=".br1" class="smoothScroll">Video</a></li>
                    <li><a href="#NoteStart" class="smoothScroll">Note</a></li>

                    <li></li>
               </ul>
          </div>

     </div>
</div>
  <div class="col-xs-12 divider">
      <div id="activeCue"></div>
    </div>

  </div>
  </div>
  </div>
  
  <div class="container" id="NoteStart" style="background-color: transparent;">
  <div class="jumbotron" style="background-color: transparent;">
      <button id="edit" class="btn btn-primary" onclick="edit()" type="button">Edit</button>
      <button id="save" class="btn btn-success" onclick="save()" type="button">Save</button>
      <button id="save" class="btn btn-danger" onclick="delNote()" type="button">Delete</button>
      <!-- <button class="btn btn-primary" onclick="getactiveCue()" type="button">Show Current Line</button> -->
      <button class="btn btn-primary" onclick="addTextToNote()" type="button">Add Text to Note</button>
     
      <div id="page-content" class="panel panel-primary" >
                    <div class="panel-heading" style="position:relative;">Note</div>
                    <div class="click2edit">
                    <div class="panel-body" id="deltext" style="overflow-y: scroll; width:auto; height:400px;">
                      
                    </div>
                    </div>
      </div>
      <button class="btn btn-success" type="button" id="saveNote">Download Note</button>
  </div> <!-- With Scroller -->
  </div>

  </body>
   <script src="js/script.js"></script>
 

  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <link href="./jQuery Word Export_files/bootstrap.min.css" rel="stylesheet">
    <link href="./jQuery Word Export_files/font-awesome.css" rel="stylesheet">
    <!-- <script src="jQuery Word Export_files/jquery-1.11.1.min.js"></script> -->
    <!-- FileSaver.js (necessary for saving the word document!) -->
    <script src="jQuery Word Export_files/FileSaver.js"></script>
    <!-- jQuery-Word-Export plugin -->
    <script src="jQuery Word Export_files/jquery.wordexport.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="jQuery Word Export_files/bootstrap.min.js"></script>
    <script type="text/javascript">
    // jQuery(document).ready(function($) {
    //     $("a.jquery-word-export").click(function(event) {
    //         console.log("click");
    //         $("#page-content").wordExport();
    //     });
    // });
    </script>
    
   
  
   
  </div>

  <footer>
  <div class="container">
    <div class="row">

               <div class="col-md-12 col-sm-12">
                    <div class="wow fadeInUp footer-copyright" data-wow-delay="1.8s">
                         <p>Copyright &copy; 2017 MOOCbook
                    </p>
                    </div>
               </div>
      
    </div>
  </div>
  </footer>

    <script>
    if (typeof jQuery !== "undefined" && typeof saveAs !== "undefined") {
    (function($) {
        $.fn.wordExport = function(fileName) {
            fileName = typeof fileName !== 'undefined' ? fileName : "MOOCbook";
            var static = {
                mhtml: {
                    top: "Mime-Version: 1.0\nContent-Base: " + location.href + "\nContent-Type: Multipart/related; boundary=\"NEXT.ITEM-BOUNDARY\";type=\"text/html\"\n\n--NEXT.ITEM-BOUNDARY\nContent-Type: text/html; charset=\"utf-8\"\nContent-Location: " + location.href + "\n\n<!DOCTYPE html>\n<html>\n_html_</html>",
                    head: "<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n<style>\n_styles_\n</style>\n</head>\n",
                    body: "<body>_body_</body>"
                }
            };
            var options = {
                maxWidth: 624
            };
            // Clone selected element before manipulating it
            var markup = $(this).clone();

            // Remove hidden elements from the output
            markup.each(function() {
                var self = $(this);
                if (self.is(':hidden'))
                    self.remove();
            });

            // Embed all images using Data URLs
            var images = Array();
            var img = markup.find('img');
            for (var i = 0; i < img.length; i++) {
                // Calculate dimensions of output image
                var w = Math.min(img[i].width, options.maxWidth);
                var h = img[i].height * (w / img[i].width);
                // Create canvas for converting image to data URL
                var canvas = document.createElement("CANVAS");
                canvas.width = w;
                canvas.height = h;
                // Draw image to canvas
                var context = canvas.getContext('2d');
                context.drawImage(img[i], 0, 0, w, h);
                // Get data URL encoding of image
                var uri = canvas.toDataURL("image/png");
                $(img[i]).attr("src", img[i].src);
                img[i].width = w;
                img[i].height = h;
                // Save encoded image to array
                images[i] = {
                    type: uri.substring(uri.indexOf(":") + 1, uri.indexOf(";")),
                    encoding: uri.substring(uri.indexOf(";") + 1, uri.indexOf(",")),
                    location: $(img[i]).attr("src"),
                    data: uri.substring(uri.indexOf(",") + 1)
                };
            }

            // Prepare bottom of mhtml file with image data
            var mhtmlBottom = "\n";
            for (var i = 0; i < images.length; i++) {
                mhtmlBottom += "--NEXT.ITEM-BOUNDARY\n";
                mhtmlBottom += "Content-Location: " + images[i].location + "\n";
                mhtmlBottom += "Content-Type: " + images[i].type + "\n";
                mhtmlBottom += "Content-Transfer-Encoding: " + images[i].encoding + "\n\n";
                mhtmlBottom += images[i].data + "\n\n";
            }
            mhtmlBottom += "--NEXT.ITEM-BOUNDARY--";

            //TODO: load css from included stylesheet
            var styles = "";

            // Aggregate parts of the file together
            var fileContent = static.mhtml.top.replace("_html_", static.mhtml.head.replace("_styles_", styles) + static.mhtml.body.replace("_body_", markup.html())) + mhtmlBottom;

            // Create a Blob with the file contents
            var blob = new Blob([fileContent], {
                type: "application/msword;charset=utf-8"
            });
            saveAs(blob, fileName + ".doc");
        };
    })(jQuery);
} else {
    if (typeof jQuery === "undefined") {
        console.error("jQuery Word Export: missing dependency (jQuery)");
    }
    if (typeof saveAs === "undefined") {
        console.error("jQuery Word Export: missing dependency (FileSaver.js)");
    }
}

jQuery(document).ready(function($) {
        $('.summernote').summernote({
        airMode: true
        });

        $("#saveNote").click(function(event) {
            save();
            console.log("click");
            $("#page-content").wordExport();
        });

        function getactiveCue(){

        var video = document.querySelector('video');
        var span = document.getElementById('activeCue');

        if (!video.textTracks) return;

        var track = video.textTracks[0];
        //track.mode = 'hidden';

        track.oncuechange = function(e) {

            var cue = this.activeCues[0];
            if (cue) {
                span.innerHTML = '';
                span.appendChild(cue.getCueAsHTML());
            }

        }
      }

      getactiveCue();
    });
  </script>
  <script type="text/javascript"></script>
  <script src="js/jquery.parallax.js"></script>
  <script src="js/smoothscroll.js"></script>
  <script src="js/wow.min.js"></script>
  <script src="js/custom.js"></script>

<script type="text/javascript">
  var edit = function() {
    console.log('sssss');
  $('.click2edit').summernote({focus: true});
};

var save = function() {
  console.log('aaaaaa');
  var makrup = $('.click2edit').summernote('code');
  $('.click2edit').summernote('destroy');
};

var delNote = function(){
  console.log('delete');
  save();
  var noteEdit = document.getElementById('deltext');
  if(!noteEdit.innerHTML == ""){
  var retVal = confirm("Are you sure?");
               if( retVal == true ){

                  noteEdit.innerHTML = "";
                  return true;
               }
               else{
                  return false;
               }
        }
   }

   var myText = "";
   var currLine = "";
   

      
      
      function addTextToNote(){
        var myTrack = document.getElementById("entrack").track; // get text track from track element          
        var myCues = myTrack.cues;  // get list of cues  
        myText = "";                   
        for (var i = 0; i < myCues.length; i++) {
            //   document.getElementById("display").innerHTML += (myCues[i].getCueAsHTML().textContent + "<br/>");  //append track label
            myText += (myCues[i].text + " ");  //append track label
        }
        
        myText = myText.replace(/&#39;/g, "'");
        console.log(myText);
        var text = myText;
        var texts = text.split(". ");
        // for (thing in texts){
        //     thing = thing+".";
        // }
        console.log(texts.length);
        //console.log(text);
        var str = document.getElementById("activeCue").innerHTML;
        var re = str;
        console.log("re="+re);
        // var found = text.search(re);
        //console.log("found="+found);
        var i = 0;
        while(i < texts.length){
          texts[i] = texts[i]+".";
          var found = texts[i].search(re);
          if(found != -1){
            console.log(texts[i]);
            $('.panel-body').append('<p>'+texts[i]+'</p>');
          }
          i++;
        }
        //console.log("text="+text[i]+text[i+1]+text[i+2]+text[i+3]+text[i+4]+text[i+5]);
      }
</script>

<script src="js/videojs.ga.js"></script>

<script>
videojs('video', {}, function() {
  this.ga(); // "load the plugin, by defaults tracks everything!!"
});

</body>
</html>                                   

 

  
  
</body>
</html>
